### Задание: Реализовать децентрализованную биржу (DEX)

#### Описание проекта:
Децентрализованная биржа (DEX) позволяет пользователям торговать токенами напрямую между кошельками без посредников. Для упрощения задания вы создадите DEX с пулом ликвидности и автоматическим маркет-мейкером (AMM), использующим модель постоянного произведения (x * y = k).

---

### Часть 1: Теоретическая база
Перед началом необходимо изучить:
1. ERC-20 токены:
   - Основные функции: transfer, approve, transferFrom.
2. AMM и формула постоянного произведения:
   - Модель x * y = k, где:
     - x и y — балансы двух токенов в пуле.
     - k — постоянное значение, обеспечивающее равновесие пула.
   - Что такое ликвидность и как она влияет на цену.
3. Смарт-контракты:
   - Основы Solidity.
   - Работа с функциями, событиями и модификаторами.

---

### Часть 2: Постановка задачи

1. Задача:
   Создать смарт-контракт для DEX, который позволяет:
   - Добавлять ликвидность в пул.
   - Убирать ликвидность из пула.
   - Обменивать токены с использованием формулы постоянного произведения.

2. Основные формулы:
   - Для обмена:
     
     Δy = (y * Δx) / (x + Δx)
     
     где:
     - x и y — текущие балансы токенов в пуле.
     - Δx — количество входящих токенов.
     - Δy — количество выдаваемых токенов.

   - Для добавления ликвидности:
     - Пользователь должен внести токены в пропорциях, равных текущим балансам пула:
       
       amountY = (amountX * y) / x
       

   - Для удаления ликвидности:
     - Пользователь получает свою долю токенов на основе выпущенных LP-токенов:
       
       amountX = (LPuser / LPtotal) * x
       amountY = (LPuser / LPtotal) * y
       

---

### Часть 3: Что нужно реализовать

1. Контракт ERC-20 для токенов ликвидности (LP-токены):
   - Реализовать токен с базовым функционалом: mint, burn, transfer.

2. Контракт DEX:
   - Переменные:
     - tokenX: адрес первого токена (например, USDC).
     - tokenY: адрес второго токена (например, WETH).
     - reserveX: текущий баланс токена X в пуле.
     - reserveY: текущий баланс токена Y в пуле.
     - totalLiquidity: общее количество LP-токенов.
   - Функции:
     - addLiquidity(uint256 amountX, uint256 amountY):
       - Добавляет токены X и Y в пул.
       - Выдает пользователю LP-токены пропорционально вносимой ликвидности.
     - removeLiquidity(uint256 lpAmount):
       - Сжигает LP-токены пользователя.
       - Возвращает токены X и Y из пула.
     - swap(uint256 amountIn, bool isXtoY):
       - Пользователь обменивает токены X на Y или наоборот.
       - Рассчитывает и обновляет резервы на основе формулы Δy.
   - События:
     - LiquidityAdded(address indexed user, uint256 amountX, uint256 amountY).
     - LiquidityRemoved(address indexed user, uint256 amountX, uint256 amountY).
     - Swapped(address indexed user, uint256 amountIn, uint256 amountOut, bool isXtoY).

3. Протестировать:
   - Корректность обмена при разных резервах.
   - Корректность добавления и удаления ликвидности.
   - Проверить равновесие формулы x * y = k после каждой операции.

---

### Часть 4: Что нужно сдать
1. Код смарт-контракта.
2. Юнит-тесты (сценарии для разных случаев).
3. Простое описание (документация), как контракт работает.

---

### Дополнительное задание:
Реализовать веб-интерфейс, чтобы пользователи могли:
- Добавлять и убирать ликвидность.
- Обменивать токены.
- Взаимодействовать с контрактом через MetaMask.
- тестировка на форки мейн нета 
- посмотреть на юнисвоп
- погонять ликвидность
- *маржинальная торговля?


-- посмотреть что такое upgradable прокси контракта (transparent) https://www.talentica.com/blogs/implementing-upgradeable-smart-contracts-using-proxy-patterns/

